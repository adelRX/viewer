<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ø³Ø¬Ø¯</title>
    <link rel="stylesheet" href="body1.css">
</head>
<body>
    <header>
      <header>
   
</header>

    </header>

<section id="hadith">
    <h2>Ø­Ø¯ÙŠØ« Ø§Ù„ÙŠÙˆÙ…</h2>
    <iframe src="https://drive.google.com/file/d/1Oe-sZGfPftXiyYyoAg23tNmfPlDZe6wT/preview" width="200" height="900"></iframe>
    
</section>



    <main>
     <section id="announcements">
    <h2>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h2>
    <div id="container"></div> <!-- Ù…ÙƒØ§Ù† Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ³Ø§Ø¦Ø· -->
    <p id="caption"></p> <!-- Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
</section>



        <aside id="sidebar">
            <h2>Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©</h2>
            <ul>
                <li><a href="#">Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØµÙ„Ø§Ø©</a></li>
                <li><a href="#">Ø§ØªØµÙ„ Ø¨Ù†Ø§</a></li>
            </ul>
        </aside>
    </main>
<script>
   const API_KEY = 'AIzaSyBRQBXAd6jap9Iy-Ia0SMxfEPK0FxeQDP4';
const FOLDER_ID = '1o4dVaF_wDCzYVpToDaRmNJTN1kLh1krV';

let mediaFiles = [];
let currentIndex = 0;
let slideshowInterval;
let refreshInterval;

async function fetchMediaFiles() {
   console.log("ðŸ” Ø¨Ø¯Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù„ÙØ§Øª...");
    const query = `'${FOLDER_ID}' in parents and (mimeType contains 'image/' or mimeType contains 'video/') and trashed = false`;
    const url = `https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(query)}&fields=files(id,name,mimeType)&key=${API_KEY}`;

    try {
        const res = await fetch(url);
        console.log("âœ… Ø§Ø³ØªØ¬Ø§Ø¨Ø© API:", res);

        if (!res.ok) {
            throw new Error(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ù„Ø¨: ${res.status}`);
        }

        const data = await res.json();
        console.log("ðŸ”Ž Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©:", data);

        if (!data.files || data.files.length === 0) {
            console.error("âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙŠ Ù…Ù„ÙØ§Øª ÙÙŠ Ø§Ù„Ù…Ø¬Ù„Ø¯.");
            document.getElementById('container').innerHTML = 'âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ³Ø§Ø¦Ø· Ù…ØªØ§Ø­Ø©.';
            return;
        }

        mediaFiles = data.files.map(file => ({
            id: file.id,
            name: file.name,
            mimeType: file.mimeType
        }));

        showMedia(mediaFiles[currentIndex]);

    } catch (e) {
        console.error("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·:", e);
        document.getElementById('container').innerHTML = 'âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª.';
    }
}

    


    try {
        const res = await fetch(url);
        const data = await res.json();

        const newFiles = data.files.map(file => ({
            id: file.id,
            name: file.name,
            mimeType: file.mimeType
        }));

        if (JSON.stringify(newFiles) !== JSON.stringify(mediaFiles)) {
            mediaFiles = newFiles;
            if (currentIndex >= mediaFiles.length) {
                currentIndex = 0;
            }
            showMedia(mediaFiles[currentIndex]);
        }
    } catch (e) {
        console.error("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·:", e);
        document.getElementById('container').innerHTML = 'âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª.';
        clearInterval(slideshowInterval);
        clearInterval(refreshInterval);
    }
}

function showMedia(file) {
    const container = document.getElementById('container');
    const caption = document.getElementById('caption');

    container.querySelectorAll("iframe, video").forEach(el => el.remove());

    caption.textContent = file.name;

    const iframe = document.createElement("iframe");
    iframe.src = `https://drive.google.com/file/d/${file.id}/preview`;
    iframe.allow = "autoplay";
    iframe.allowFullscreen = true;
    iframe.frameBorder = 0;
    iframe.style.width = "100%";
    iframe.style.height = "400px";

    container.insertBefore(iframe, caption);
}

function startSlideshow() {
    slideshowInterval = setInterval(() => {
        currentIndex = (currentIndex + 1) % mediaFiles.length;
        showMedia(mediaFiles[currentIndex]);
    }, 20000); // ØªØºÙŠÙŠØ± ÙƒÙ„ 20 Ø«Ø§Ù†ÙŠØ©
}

function startAutoRefresh() {
    refreshInterval = setInterval(fetchMediaFiles, 60000); // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
}

async function init() {
    await fetchMediaFiles();
    startSlideshow();
    startAutoRefresh();
}

init();

</script>




</body>






</html>
